# Semtech SX1262 LoRa Chip

## Chip Initialization (One-Time Operations)

To properly initialize the chip, the following operations are needed:

1. `SetStandby(...)`: go to STDBY_RC mode if not already there
2. `SetPacketType(...)`: select LoRa protocol instead of FSK
3. `SetRfFrequency(...)`: set the RF frequency
4. `SetPaConfig(...)`: define Power Amplifier configuration
5. `SetTxParams(...)`: define output power and ramping time
6. `SetModulationParams(...)`: SF, BW, CR (LoRa)
7. `SetDioIrqParams(...)`: map `TxDone`/`RxDone` to DIO pins
8. `WriteReg(...)`: for SyncWord if a non-default is needed

## Per-Packet Tx Operations

These are the operations that must be performed in order to send a simple LoRa packet. These are assuming that the proper initialization steps above have already been performed.

1. `SetPacketParams(...)`: preamble, header mode, CRC, payload length mode (explicit/implicit)
2. `SetBufferBaseAddress(txBase, rxBase)`: can do this once if always using the same base
3. `WriteBuffer(offset, payload, length)`: put packet ito radio buffer
4. `SetTx(timeout)`: start transmission
5. Wait for `TxDone` (IRQ) or timeout
6. `ClearIrqStatus(...)`: clear TxDone

## Per-Packet Rx Operations

These are the operations that must be performed in order to receive a simple LoRa packet. These are assuming that the proper initialization steps above have already been performed.

1. `ClearIrqStatus(...)`: clear any pending IRQs before starting a new receive
2. Enter Rx mode with either:
    1. `SetRx(timeout)` for finite listening
        - Will stop and go back to `STDBY_RC` if no packet
    2. `SetRx(0xFFFFFF)` for continuous receive
        - Stays in Rx until told otherwise
3. Wait for `RxDone` (IRQ) or timeout
    - Can use DIO1 interrupt or poll `GetIrqStatus()`
4. Check CRC: Even if `RxDone`, check IRQ flags for CRC error
    - If CRC OK: proceed
    - If CRC fail: discard
5. `GetRxBufferStatus(...)`: Get buffer info, gives `payloadLen` and starting offset
6. `ReadBuffer(...)`: pull out the received data
7. `ClearIrqStatus(...)`: clear the status (`IRQ_RX_DONE`, `IRQ_TIMEOUT`, `IRQ_CRC_ERROR`) depending on what fired
8. Decide what's next:
    - Stay in continuous Rx, chip keeps listening automatically
    - If timeout used, need to call `SetRx()` again in order to keep listening